{"ast":null,"code":"var _jsxFileName = \"/Users/horikazuto/ChooseOne/LatestChooseOne/src/screens/Home.js\",\n    _s = $RefreshSig$();\n\nimport React, { useState, useEffect, Fragment } from 'react';\nimport { Helmet } from \"react-helmet\";\nimport InfiniteScroll from \"react-infinite-scroller\";\nimport axios from \"axios\";\nimport QuestionList from '../components/QuestionList.js'; // Firebase\n\nimport { getApps, initializeApp } from 'firebase/app';\nimport { getFirestore, collection, query, orderBy, limit, startAfter, getDocs } from \"firebase/firestore\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst firebaseConfig = {\n  apiKey: \"AIzaSyArjDv3hS4_rw1YyNz-JFXDX1ufF72bqr8\",\n  authDomain: \"chooseone-105a9.firebaseapp.com\",\n  databaseURL: \"https://chooseone-default-rtdb.firebaseio.com\",\n  projectId: \"chooseone\",\n  storageBucket: \"chooseone.appspot.com\",\n  messagingSenderId: \"722704825746\",\n  appId: \"1:722704825746:web:73f11551b9e59f4bc2d54b\",\n  measurementId: \"G-YJ97DZH6V5\"\n};\nvar db = '';\n\nif (!getApps().length) {\n  const firebaseApp = initializeApp(firebaseConfig);\n  db = getFirestore(firebaseApp);\n} else {\n  db = getFirestore();\n}\n\nexport default function Home() {\n  _s();\n\n  const [questions, setQuestions] = useState([]);\n  const [hasMore, setHasMore] = useState(true);\n  const [end, setEnd] = useState(null);\n  const [last, setLast] = useState(null);\n  useEffect(() => {\n    if (questions.length !== 0) return null;\n    axios.get('http://127.0.0.1:8000/api/').then(response => {\n      console.log(response);\n      setQuestions(response.data);\n      console.log(questions);\n    }).catch(error => {\n      console.log(error);\n    });\n    const q = query(collection(db, 'questions'), orderBy('created_at', 'desc'), limit(10));\n    const promiseD = new Promise(function (resolve, reject) {\n      resolve(getDocs(q));\n    });\n    promiseD.then(qq => {\n      var ques = [];\n      Promise.all(qq.docs.map(async doc => {\n        ques.push(doc.data());\n        if (ques.length === 10) setLast(doc);\n      })).then(() => {\n        setQuestions(ques);\n      });\n    }, []);\n\n    if (end === null) {\n      setEnd(query(collection(db, 'questions'), orderBy('created_at', 'asc'), limit(1)));\n    }\n  });\n\n  const loadMore = async page => {\n    var more = true;\n    setHasMore(false); // const next = await getDocs(query(collection(db, 'questions'), orderBy('created_at', 'desc'), startAfter(last), limit(10)));\n    // var ques = [];\n    // await Promise.all(next.docs.map(async doc => {\n    //   ques.push(doc.data());\n    //   if(doc === end || ques.length === 10) {\n    //     if(doc === end) more = false;\n    //     setLast(doc);\n    //   }\n    // })).then(() => setQuestions(questions.concat(ques)));\n    // if(more) setHasMore(true);\n    // else setHasMore(false);\n  };\n\n  return /*#__PURE__*/_jsxDEV(Fragment, {\n    children: [/*#__PURE__*/_jsxDEV(Helmet, {\n      title: \"ChooseOne\",\n      meta: [{\n        name: 'description',\n        content: 'ChooseOne lets you have access to general understandings through user-interactive questions. The more you vote, the more you can influence the results, and it can be helpful to all the people who want to know the results.'\n      }]\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 89,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(InfiniteScroll, {\n      loadMore: loadMore,\n      hasMore: hasMore,\n      threshold: 500,\n      loader: /*#__PURE__*/_jsxDEV(\"div\", {}, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 99,\n        columnNumber: 17\n      }, this),\n      children: /*#__PURE__*/_jsxDEV(QuestionList, {\n        questions: questions\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 101,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 95,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 88,\n    columnNumber: 5\n  }, this);\n}\n\n_s(Home, \"pNT8SY/dFY7WALe2cm8WfCg3E3U=\");\n\n_c = Home;\n\nvar _c;\n\n$RefreshReg$(_c, \"Home\");","map":{"version":3,"sources":["/Users/horikazuto/ChooseOne/LatestChooseOne/src/screens/Home.js"],"names":["React","useState","useEffect","Fragment","Helmet","InfiniteScroll","axios","QuestionList","getApps","initializeApp","getFirestore","collection","query","orderBy","limit","startAfter","getDocs","firebaseConfig","apiKey","authDomain","databaseURL","projectId","storageBucket","messagingSenderId","appId","measurementId","db","length","firebaseApp","Home","questions","setQuestions","hasMore","setHasMore","end","setEnd","last","setLast","get","then","response","console","log","data","catch","error","q","promiseD","Promise","resolve","reject","qq","ques","all","docs","map","doc","push","loadMore","page","more","name","content"],"mappings":"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","sourcesContent":["import React, { useState, useEffect, Fragment } from 'react';\nimport { Helmet } from \"react-helmet\";\nimport InfiniteScroll  from \"react-infinite-scroller\"\nimport axios from \"axios\";\n\nimport QuestionList from '../components/QuestionList.js';\n\n// Firebase\nimport { getApps, initializeApp } from 'firebase/app';\nimport { getFirestore, collection, query, orderBy, limit, startAfter, getDocs } from \"firebase/firestore\";\nconst firebaseConfig = {\n  apiKey: \"AIzaSyArjDv3hS4_rw1YyNz-JFXDX1ufF72bqr8\",\n  authDomain: \"chooseone-105a9.firebaseapp.com\",\n  databaseURL: \"https://chooseone-default-rtdb.firebaseio.com\",\n  projectId: \"chooseone\",\n  storageBucket: \"chooseone.appspot.com\",\n  messagingSenderId: \"722704825746\",\n  appId: \"1:722704825746:web:73f11551b9e59f4bc2d54b\",\n  measurementId: \"G-YJ97DZH6V5\"\n};\nvar db = '';\nif (!getApps().length){ \n  const firebaseApp = initializeApp(firebaseConfig);\n  db = getFirestore(firebaseApp);\n}else{\n  db = getFirestore();\n}\n\n\nexport default function Home () {\n\n  const [questions, setQuestions] = useState([]);\n  const [hasMore, setHasMore] = useState(true);\n  const [end, setEnd] = useState(null);\n  const [last, setLast] = useState(null);\n\n  useEffect(() => {\n    if(questions.length !== 0) return null;\n\n    axios.get('http://127.0.0.1:8000/api/')\n      .then(response => {\n        console.log(response);\n        setQuestions(response.data)\n        console.log(questions);\n      })\n      .catch(error => {\n        console.log(error);\n      })\n\n    const q = query(collection(db, 'questions'), orderBy('created_at', 'desc'), limit(10))\n    const promiseD = new Promise(function(resolve, reject) {\n      resolve(getDocs(q));\n    });\n    promiseD.then((qq) => {\n      var ques = [];\n      Promise.all(qq.docs.map(async doc => {\n        ques.push(doc.data());\n        if(ques.length === 10) setLast(doc);\n      })).then(() => {\n        setQuestions(ques);\n      })\n    }, []);\n\n    if(end === null){\n      setEnd(query(collection(db, 'questions'), orderBy('created_at', 'asc'), limit(1)));\n    }\n  });\n\n  const loadMore = async (page) => {\n    var more = true;\n    setHasMore(false);\n\n    // const next = await getDocs(query(collection(db, 'questions'), orderBy('created_at', 'desc'), startAfter(last), limit(10)));\n    // var ques = [];\n    // await Promise.all(next.docs.map(async doc => {\n    //   ques.push(doc.data());\n    //   if(doc === end || ques.length === 10) {\n    //     if(doc === end) more = false;\n    //     setLast(doc);\n    //   }\n    // })).then(() => setQuestions(questions.concat(ques)));\n\n    // if(more) setHasMore(true);\n    // else setHasMore(false);\n  }\n\n  return (\n    <Fragment>\n      <Helmet\n        title = 'ChooseOne'\n        meta={[\n          { name: 'description', content: 'ChooseOne lets you have access to general understandings through user-interactive questions. The more you vote, the more you can influence the results, and it can be helpful to all the people who want to know the results.' }\n        ]}\n      />\n      <InfiniteScroll\n        loadMore={loadMore}\n        hasMore={hasMore}\n        threshold={500}\n        loader={<div></div> }\n      >\n        <QuestionList questions={questions} />\n      </InfiniteScroll>\n    </Fragment>\n  )\n}\n"]},"metadata":{},"sourceType":"module"}