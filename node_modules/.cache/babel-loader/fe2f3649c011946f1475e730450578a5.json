{"ast":null,"code":"var _jsxFileName = \"/Users/horikazuto/ChooseOne/LatestChooseOne/src/components/Question.js\",\n    _s = $RefreshSig$();\n\nimport React, { Fragment, useState, useEffect } from 'react';\nimport Skeleton, { SkeletonTheme } from 'react-loading-skeleton';\nimport useMediaQuery from '@material-ui/core/useMediaQuery';\nimport { makeStyles, createStyles } from '@material-ui/core';\nimport { createMuiTheme, ThemeProvider, withStyles } from '@material-ui/core/styles';\nimport ButtonGroup from '@material-ui/core/ButtonGroup';\nimport Button from '@material-ui/core/Button';\nimport { Bar } from 'react-chartjs-2';\nimport axios from \"axios\";\nimport HoriChart from './HoriChart'; // Firebase\n\nimport { getApps, initializeApp } from 'firebase/app';\nimport { getFirestore, updateDoc, increment, collection, deleteDoc, startAfter, arrayRemove, arrayUnion, query, where, getDoc, doc, getDocs, orderBy, limit } from \"firebase/firestore\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst firebaseConfig = {\n  apiKey: \"AIzaSyArjDv3hS4_rw1YyNz-JFXDX1ufF72bqr8\",\n  authDomain: \"chooseone-105a9.firebaseapp.com\",\n  databaseURL: \"https://chooseone-default-rtdb.firebaseio.com\",\n  projectId: \"chooseone\",\n  storageBucket: \"chooseone.appspot.com\",\n  messagingSenderId: \"722704825746\",\n  appId: \"1:722704825746:web:73f11551b9e59f4bc2d54b\",\n  measurementId: \"G-YJ97DZH6V5\"\n};\nvar db = '';\n\nif (!getApps().length) {\n  const firebaseApp = initializeApp(firebaseConfig);\n  db = getFirestore(firebaseApp);\n} else {\n  db = getFirestore();\n}\n\nexport default function QuestionList(props) {\n  _s();\n\n  const theme = createMuiTheme({\n    palette: {\n      primary: {\n        main: 'rgb(3, 122, 255)'\n      },\n      secondary: {\n        main: '#f50057'\n      },\n      green: {\n        main: 'rgb(40, 168, 69)'\n      }\n    }\n  });\n  const uid = localStorage.getItem('chooseoneUid'); // const [your_vote, setYourVote] = useState(null);\n\n  const [answered, setAnswered] = useState(false);\n  const styles = useStyles();\n  var l = [];\n  var v = [];\n  var c = [];\n  const the_question = props.the_question;\n  const notLoaded = the_question.category === null || the_question.category === undefined;\n  const smallDisplay = useMediaQuery('(max-width:500px)');\n  var choiceSkeleton = [];\n\n  for (var i = 0; i < 5 - smallDisplay * 2; i++) {\n    choiceSkeleton.push( /*#__PURE__*/_jsxDEV(\"div\", {\n      children: /*#__PURE__*/_jsxDEV(\"label\", {\n        for: \"choice{idx}\",\n        children: /*#__PURE__*/_jsxDEV(Skeleton, {\n          duration: 2.5,\n          width: 150,\n          height: 10\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 68,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 67,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 66,\n      columnNumber: 7\n    }, this));\n  }\n\n  if (the_question !== 'skeleton' && the_question !== undefined) {\n    var copy = the_question.choices;\n\n    for (let i = 0; i < copy.length; i++) {\n      l.push(copy[i].choice_text);\n      v.push(copy[i].votes);\n    }\n\n    var time = the_question.created_at;\n    var seconds = parseInt(time.slice(-2));\n\n    if (v !== []) {\n      v.forEach((entry, idx) => {\n        c.push('hsla(' + (idx + seconds) * 70 + ',75%,75%,1)');\n      });\n    }\n  }\n\n  useEffect(() => {\n    if (uid === null) return null;\n    const u = doc(db, 'users', uid); // const promise = new Promise(function(resolve) {\n    //   resolve(getDoc(u));\n    // })\n    // promise.then((us) => {\n    //   if(us.exists){\n    //     var the_user = us.data();\n    //     if(the_user.question_voted.some((q) => q.question === the_question.slug)){\n    //       setAnswered(true);\n    //     }\n    //   }\n    // });\n  });\n\n  const onChoice = async idx => {\n    var the_slug = the_question.slug;\n    var your_vote = the_question.choices[idx].choice_text;\n    setAnswered(true);\n    var copy = Object.create(the_question);\n    copy.choices[idx].votes = parseInt(copy.choices[idx].votes, 10) + 1;\n    await updateDoc(doc(db, 'questions', the_question.slug), {\n      choices: copy.choices,\n      all_votes: increment(1),\n      users_voted: arrayUnion(uid)\n    });\n    await updateDoc(doc(db, 'users', uid), {\n      question_voted: arrayUnion({\n        question: the_slug,\n        answer: your_vote\n      })\n    });\n  };\n\n  return /*#__PURE__*/_jsxDEV(Fragment, {\n    children: /*#__PURE__*/_jsxDEV(\"div\", {\n      className: styles.onepost,\n      children: [/*#__PURE__*/_jsxDEV(\"p\", {\n        className: \"cali2\",\n        style: {\n          fontSize: 12\n        },\n        children: [/*#__PURE__*/_jsxDEV(\"span\", {\n          className: \"text-primary fa fa-tag\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 135,\n          columnNumber: 55\n        }, this), \"Category:\", !notLoaded && /*#__PURE__*/_jsxDEV(Fragment, {\n          children: the_question.category.map((cate, idx) => {\n            if (idx === 0) {\n              return /*#__PURE__*/_jsxDEV(\"a\", {\n                className: \"text-primary\",\n                href: '/category/' + cate,\n                children: [\" \", cate]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 141,\n                columnNumber: 27\n              }, this);\n            } else {\n              return /*#__PURE__*/_jsxDEV(\"a\", {\n                className: \"text-primary\",\n                href: '/category/' + cate,\n                children: [\", \", cate]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 143,\n                columnNumber: 27\n              }, this);\n            }\n          })\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 138,\n          columnNumber: 13\n        }, this), notLoaded && /*#__PURE__*/_jsxDEV(Skeleton, {\n          style: {\n            marginLeft: 10\n          },\n          width: 60\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 148,\n          columnNumber: 25\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 135,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"h4\", {\n        style: {\n          fontSize: 19\n        },\n        className: \"cali2\",\n        children: /*#__PURE__*/_jsxDEV(\"a\", {\n          className: styles.link,\n          href: '/q/' + the_question.slug,\n          children: !notLoaded ? the_question.title : /*#__PURE__*/_jsxDEV(SkeletonTheme, {\n            color: \"white\",\n            highlightColor: \"#d3d3d3\",\n            children: /*#__PURE__*/_jsxDEV(Skeleton, {\n              duration: 2.5,\n              width: '80%',\n              height: 20\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 150,\n              columnNumber: 203\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 150,\n            columnNumber: 149\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 150,\n          columnNumber: 56\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 150,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: styles.choices,\n        style: {\n          paddingLeft: smallDisplay && answered && 0,\n          paddingRight: !smallDisplay && answered && 35\n        },\n        children: /*#__PURE__*/_jsxDEV(\"ul\", {\n          style: {\n            paddingLeft: 0\n          },\n          children: [!notLoaded && /*#__PURE__*/_jsxDEV(Fragment, {\n            children: !answered ? /*#__PURE__*/_jsxDEV(Fragment, {\n              children: the_question.choices.map((choice, idx) => /*#__PURE__*/_jsxDEV(\"div\", {\n                children: /*#__PURE__*/_jsxDEV(StyledButton, {\n                  variant: \"outlined\",\n                  onClick: () => onChoice(idx),\n                  size: \"small\",\n                  color: \"primary\",\n                  children: choice.choice_text\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 162,\n                  columnNumber: 25\n                }, this)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 159,\n                columnNumber: 23\n              }, this))\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 157,\n              columnNumber: 19\n            }, this) : /*#__PURE__*/_jsxDEV(Fragment, {\n              children: /*#__PURE__*/_jsxDEV(\"div\", {\n                className: styles.HoriChart,\n                children: /*#__PURE__*/_jsxDEV(HoriChart, {\n                  small: smallDisplay,\n                  skeleton: notLoaded,\n                  labels: l,\n                  values: v,\n                  colors: c\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 170,\n                  columnNumber: 55\n                }, this)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 170,\n                columnNumber: 21\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 169,\n              columnNumber: 19\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 155,\n            columnNumber: 15\n          }, this), notLoaded && [choiceSkeleton]]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 153,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 152,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: styles.more,\n        children: /*#__PURE__*/_jsxDEV(ThemeProvider, {\n          theme: theme,\n          children: /*#__PURE__*/_jsxDEV(ButtonGroup, {\n            size: smallDisplay ? 'small' : 'default',\n            disableElevation: true,\n            variant: \"contained\",\n            children: /*#__PURE__*/_jsxDEV(Button, {\n              variant: \"contained\",\n              onClick: () => window.location.href = '/q/' + the_question.slug,\n              color: \"primary\",\n              children: \"More\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 181,\n              columnNumber: 15\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 180,\n            columnNumber: 13\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 179,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 178,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 133,\n      columnNumber: 7\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 132,\n    columnNumber: 5\n  }, this);\n}\n\n_s(QuestionList, \"S5N6UdnbSGbi/IUVLCoQL3GzjIs=\", false, function () {\n  return [useStyles, useMediaQuery];\n});\n\n_c = QuestionList;\nconst useStyles = makeStyles(() => createStyles({\n  more: {\n    marginBottom: 10,\n    marginLeft: 12\n  },\n  onepost: {\n    padding: 10,\n    paddingLeft: 15,\n    marginBottom: 15,\n    filter: 'drop-shadow(0px 0px 5px rgba(160, 160, 160, 0.7))',\n    backgroundColor: 'white',\n    position: 'relative',\n    borderRadius: 15\n  },\n  choices: {\n    paddingLeft: 40\n  },\n  link: {\n    color: 'black',\n    '&:hover': {\n      background: 'linear-gradient(transparent 70%, #45cafb 0%)',\n      textDecoration: 'none'\n    }\n  },\n  '@media (max-width: 500px)': {\n    onepost: {\n      borderRadius: 0,\n      marginBottom: 5,\n      paddingLeft: 10,\n      paddingBottom: 1,\n      filter: 'none',\n      link: {\n        '&:hover': {\n          background: 'none'\n        }\n      }\n    }\n  }\n}));\nconst StyledButton = withStyles({\n  root: {\n    borderRadius: 7,\n    borderColor: '#696969',\n    borderWidth: 0.1,\n    color: '#696969',\n    fontSize: 11,\n    width: Math.min(200, window.innerWidth * 0.5),\n    textTransform: 'none',\n    margin: 2,\n    paddingLeft: 12,\n    alignItems: 'center',\n    justifyContent: 'start'\n  },\n  '@media (max-width: 500px)': {\n    root: {\n      width: window.innerWidth * 0.5\n    }\n  }\n})(Button);\n\nvar _c;\n\n$RefreshReg$(_c, \"QuestionList\");","map":{"version":3,"sources":["/Users/horikazuto/ChooseOne/LatestChooseOne/src/components/Question.js"],"names":["React","Fragment","useState","useEffect","Skeleton","SkeletonTheme","useMediaQuery","makeStyles","createStyles","createMuiTheme","ThemeProvider","withStyles","ButtonGroup","Button","Bar","axios","HoriChart","getApps","initializeApp","getFirestore","updateDoc","increment","collection","deleteDoc","startAfter","arrayRemove","arrayUnion","query","where","getDoc","doc","getDocs","orderBy","limit","firebaseConfig","apiKey","authDomain","databaseURL","projectId","storageBucket","messagingSenderId","appId","measurementId","db","length","firebaseApp","QuestionList","props","theme","palette","primary","main","secondary","green","uid","localStorage","getItem","answered","setAnswered","styles","useStyles","l","v","c","the_question","notLoaded","category","undefined","smallDisplay","choiceSkeleton","i","push","copy","choices","choice_text","votes","time","created_at","seconds","parseInt","slice","forEach","entry","idx","u","onChoice","the_slug","slug","your_vote","Object","create","all_votes","users_voted","question_voted","question","answer","onepost","fontSize","map","cate","marginLeft","link","title","paddingLeft","paddingRight","choice","more","window","location","href","marginBottom","padding","filter","backgroundColor","position","borderRadius","color","background","textDecoration","paddingBottom","StyledButton","root","borderColor","borderWidth","width","Math","min","innerWidth","textTransform","margin","alignItems","justifyContent"],"mappings":"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","sourcesContent":["import React, { Fragment, useState, useEffect } from 'react';\nimport Skeleton, { SkeletonTheme } from 'react-loading-skeleton';\nimport useMediaQuery from '@material-ui/core/useMediaQuery';\nimport { makeStyles, createStyles } from '@material-ui/core';\nimport { createMuiTheme, ThemeProvider, withStyles } from '@material-ui/core/styles';\nimport ButtonGroup from '@material-ui/core/ButtonGroup';\nimport Button from '@material-ui/core/Button';\nimport { Bar } from 'react-chartjs-2';\nimport axios from \"axios\";\n\nimport HoriChart from './HoriChart';\n\n// Firebase\nimport { getApps, initializeApp } from 'firebase/app';\nimport { getFirestore, updateDoc, increment, collection, deleteDoc, startAfter, arrayRemove, arrayUnion, query, \n      where, getDoc, doc, getDocs, orderBy, limit } from \"firebase/firestore\";\nconst firebaseConfig = {\n  apiKey: \"AIzaSyArjDv3hS4_rw1YyNz-JFXDX1ufF72bqr8\",\n  authDomain: \"chooseone-105a9.firebaseapp.com\",\n  databaseURL: \"https://chooseone-default-rtdb.firebaseio.com\",\n  projectId: \"chooseone\",\n  storageBucket: \"chooseone.appspot.com\",\n  messagingSenderId: \"722704825746\",\n  appId: \"1:722704825746:web:73f11551b9e59f4bc2d54b\",\n  measurementId: \"G-YJ97DZH6V5\"\n};\nvar db = '';\nif (!getApps().length){ \n  const firebaseApp = initializeApp(firebaseConfig);\n  db = getFirestore(firebaseApp);\n}else{\n  db = getFirestore();\n}\n\nexport default function QuestionList (props) {\n\n  const theme = createMuiTheme({\n    palette: {\n      primary: {\n        main: 'rgb(3, 122, 255)',\n      },\n      secondary: {\n        main: '#f50057',\n      },\n      green: {\n        main: 'rgb(40, 168, 69)',\n      }\n    },\n  });\n\n  const uid = localStorage.getItem('chooseoneUid');\n  // const [your_vote, setYourVote] = useState(null);\n  const [answered, setAnswered] = useState(false);\n  const styles = useStyles();\n  var l = [];\n  var v = [];\n  var c = [];\n\n  const the_question = props.the_question;\n  const notLoaded = (the_question.category === null || the_question.category === undefined);\n  const smallDisplay = useMediaQuery('(max-width:500px)');\n  var choiceSkeleton = [];\n\n  for(var i=0; i<(5-smallDisplay*2); i++){\n    choiceSkeleton.push(\n      <div>\n        <label for=\"choice{idx}\">\n          <Skeleton duration={2.5} width={150} height={10}/>\n        </label>\n      </div>\n    )\n  }\n\n  if(the_question !== 'skeleton' && the_question !== undefined){\n    var copy = the_question.choices;\n\n    for(let i=0; i<copy.length;  i++){\n      l.push(copy[i].choice_text);\n      v.push(copy[i].votes);\n    }\n\n    var time = the_question.created_at;\n    var seconds = parseInt(time.slice(-2));\n    if(v !== []){\n      v.forEach((entry, idx) => {\n        c.push('hsla('+((idx+seconds)*70)+',75%,75%,1)');\n      });\n    }\n  }\n\n  useEffect(() => {\n    if(uid === null) return null;\n\n    const u = doc(db, 'users', uid);\n    // const promise = new Promise(function(resolve) {\n    //   resolve(getDoc(u));\n    // })\n    // promise.then((us) => {\n    //   if(us.exists){\n    //     var the_user = us.data();\n\n    //     if(the_user.question_voted.some((q) => q.question === the_question.slug)){\n    //       setAnswered(true);\n    //     }\n    //   }\n    // });\n  });\n\n  const onChoice = async (idx) => {\n    var the_slug = the_question.slug;\n    var your_vote = the_question.choices[idx].choice_text;\n\n    setAnswered(true);\n\n    var copy = Object.create(the_question);\n\n    copy.choices[idx].votes=parseInt(copy.choices[idx].votes, 10)+1;\n    \n\n    await updateDoc(doc(db, 'questions', the_question.slug), {\n      choices: copy.choices,\n      all_votes: increment(1),\n      users_voted: arrayUnion(uid),\n    });\n\n    await updateDoc(doc(db, 'users', uid), {\n      question_voted: arrayUnion({ question: the_slug, answer: your_vote }),\n    })\n  }\n\n  return (\n    <Fragment>\n      <div className={styles.onepost}>\n        \n        <p className='cali2' style={{ fontSize: 12 }}><span className='text-primary fa fa-tag'></span>\n          Category:\n          {!notLoaded && (\n            <Fragment>\n              {the_question.category.map((cate, idx) => {\n                if ( idx === 0){\n                  return (<a className='text-primary' href={'/category/'+cate}> {cate}</a>)\n                }else{\n                  return (<a className='text-primary' href={'/category/'+cate}>, {cate}</a>)\n                }\n              })}\n            </Fragment>\n          )}\n          {notLoaded && <Skeleton style={{ marginLeft: 10 }} width={60} />}\n        </p>\n        <h4 style={{ fontSize: 19 }} className='cali2'><a className={styles.link} href={'/q/'+the_question.slug}>{!notLoaded ? the_question.title : <SkeletonTheme color=\"white\" highlightColor=\"#d3d3d3\"><Skeleton duration={2.5} width={'80%'} height={20}  /></SkeletonTheme> }</a></h4>\n\n        <div className={styles.choices} style={{ paddingLeft: smallDisplay && answered && 0, paddingRight: !smallDisplay && answered && 35 }}>\n          <ul style={{ paddingLeft: 0 }}>\n            {!notLoaded && (\n              <Fragment>\n                {!answered ?\n                  <Fragment>\n                    {the_question.choices.map((choice,idx) => (\n                      <div>\n                        {/* <label for=\"choice{idx}\">○ {choice.choice_text}</label>\n                        <br></br> */}\n                        <StyledButton variant=\"outlined\" onClick={() => onChoice(idx)} size=\"small\" color=\"primary\">\n                          {choice.choice_text}\n                        </StyledButton>\n                      </div>\n                    ))}\n                  </Fragment>\n                  :\n                  <Fragment>\n                    <div className={styles.HoriChart}><HoriChart small={smallDisplay} skeleton={notLoaded} labels={l} values={v} colors={c} /></div>\n                  </Fragment>\n                }\n              </Fragment>\n            )}\n            {notLoaded && [choiceSkeleton]}\n          </ul>\n        </div>\n        <div className={styles.more}>\n          <ThemeProvider theme={theme}>\n            <ButtonGroup size={smallDisplay ? 'small' : 'default'} disableElevation variant=\"contained\" >\n              <Button variant='contained' onClick={() => window.location.href = '/q/'+the_question.slug } color=\"primary\">\n                More\n              </Button>\n            </ButtonGroup>\n          </ThemeProvider>\n        </div>\n      </div>\n    </Fragment>\n  );\n}\n\nconst useStyles = makeStyles(() => createStyles({\n  more: {\n    marginBottom: 10,\n    marginLeft: 12,\n  },\n  onepost: {\n    padding: 10,\n    paddingLeft: 15,\n    marginBottom: 15,\n    filter: 'drop-shadow(0px 0px 5px rgba(160, 160, 160, 0.7))',\n    backgroundColor: 'white',\n    position: 'relative',\n    borderRadius: 15,\n  },\n\n  choices: {\n    paddingLeft: 40,\n  },\n\n  link: {\n    color: 'black',\n    '&:hover': {\n      background: 'linear-gradient(transparent 70%, #45cafb 0%)',\n      textDecoration: 'none',\n    }\n  },\n  \n  '@media (max-width: 500px)': {\n    onepost: {\n      borderRadius: 0,\n      marginBottom: 5,\n      paddingLeft: 10,\n      paddingBottom: 1,\n      filter: 'none',\n\n      link: {\n        '&:hover': {\n          background: 'none',\n        }\n      }\n    }\n  }\n}));\n\nconst StyledButton = withStyles({\n  root: {\n    borderRadius: 7,\n    borderColor: '#696969', \n    borderWidth: 0.1,\n    color: '#696969', \n    fontSize: 11, \n    width: Math.min(200, window.innerWidth*0.5),\n    textTransform: 'none',\n    margin: 2,\n    paddingLeft: 12,\n    alignItems: 'center',\n    justifyContent: 'start',\n  },\n\n  '@media (max-width: 500px)': {\n    root: {\n      width: window.innerWidth*0.5,\n    }\n  }\n})(Button);"]},"metadata":{},"sourceType":"module"}