{"ast":null,"code":"import _regeneratorRuntime from\"/Users/horikazuto/ChooseOne/LatestChooseOne/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"/Users/horikazuto/ChooseOne/LatestChooseOne/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _slicedToArray from\"/Users/horikazuto/ChooseOne/LatestChooseOne/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React,{useEffect,useState,Fragment}from'react';import{Helmet}from\"react-helmet\";import InfiniteScroll from\"react-infinite-scroller\";import{makeStyles,createStyles}from'@material-ui/core';import QuestionList from'../components/QuestionList.js';// Firebase\nimport{getApps,initializeApp}from'firebase/app';import{getFirestore,collection,query,where,getDocs,orderBy,limit,startAfter}from\"firebase/firestore\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var firebaseConfig={apiKey:\"AIzaSyArjDv3hS4_rw1YyNz-JFXDX1ufF72bqr8\",authDomain:\"chooseone-105a9.firebaseapp.com\",databaseURL:\"https://chooseone-default-rtdb.firebaseio.com\",projectId:\"chooseone\",storageBucket:\"chooseone.appspot.com\",messagingSenderId:\"722704825746\",appId:\"1:722704825746:web:73f11551b9e59f4bc2d54b\",measurementId:\"G-YJ97DZH6V5\"};var db='';if(!getApps().length){var firebaseApp=initializeApp(firebaseConfig);db=getFirestore(firebaseApp);}else{db=getFirestore();}export default function QuestionCategory(props){var _useState=useState([]),_useState2=_slicedToArray(_useState,2),questions=_useState2[0],setQuestions=_useState2[1];var _useState3=useState(true),_useState4=_slicedToArray(_useState3,2),hasMore=_useState4[0],setHasMore=_useState4[1];var _useState5=useState(null),_useState6=_slicedToArray(_useState5,2),end=_useState6[0],setEnd=_useState6[1];var _useState7=useState(null),_useState8=_slicedToArray(_useState7,2),last=_useState8[0],setLast=_useState8[1];var category=props.match.params.category;var styles=useStyles();useEffect(function(){if(questions.length!==0)return null;var q=query(collection(db,'questions'),where('category','array-contains',category),orderBy('created_at','desc'),limit(10));var promise=new Promise(function(resolve,reject){resolve(getDocs(q));});promise.then(function(qq){var ques=[];Promise.all(qq.docs.map(/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(doc){return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:ques.push(doc.data());if(ques.length===10)setLast(doc);case 2:case\"end\":return _context.stop();}}},_callee);}));return function(_x){return _ref.apply(this,arguments);};}())).then(function(){setQuestions(ques);});});if(end===null){setEnd(query(collection(db,'questions'),where('category','array-contains',category),orderBy('created_at','asc'),limit(1)));}});var loadMore=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee3(page){var more,next,ques;return _regeneratorRuntime.wrap(function _callee3$(_context3){while(1){switch(_context3.prev=_context3.next){case 0:more=true;setHasMore(false);_context3.next=4;return getDocs(query(collection(db,'questions'),where('category','array-contains',category),orderBy('created_at','desc'),startAfter(last),limit(10)));case 4:next=_context3.sent;ques=[];_context3.next=8;return Promise.all(next.docs.map(/*#__PURE__*/function(){var _ref3=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(doc){return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:ques.push(doc.data());if(doc===end||ques.length===10){if(doc===end)more=false;setLast(doc);}case 2:case\"end\":return _context2.stop();}}},_callee2);}));return function(_x3){return _ref3.apply(this,arguments);};}())).then(function(){return setQuestions(questions.concat(ques));});case 8:if(more)setHasMore(true);else setHasMore(false);case 9:case\"end\":return _context3.stop();}}},_callee3);}));return function loadMore(_x2){return _ref2.apply(this,arguments);};}();return/*#__PURE__*/_jsxs(Fragment,{children:[/*#__PURE__*/_jsx(Helmet,{title:'Questions Categorized as '+category,meta:[{name:'description',content:'ChooseOne lets you have access to general understandings through user-interactive questions. The more you vote, the more you can influence the results, and it can be helpful to all the people who want to know the results.'}]}),/*#__PURE__*/_jsxs(\"p\",{className:styles.title,children:[\"Questions Categorized as \",category]}),/*#__PURE__*/_jsx(InfiniteScroll,{loadMore:loadMore,hasMore:hasMore,threshold:500,loader:/*#__PURE__*/_jsx(\"div\",{}),children:/*#__PURE__*/_jsx(QuestionList,{questions:questions})})]});}var useStyles=makeStyles(function(){return createStyles({title:{fontFamily:'lust-script, sans-serif',fontStyle:'normal',fontWeight:700,fontSize:24},'@media (max-width: 500px)':{title:{fontSize:22,marginLeft:15,marginTop:7}}});});","map":{"version":3,"sources":["/Users/horikazuto/ChooseOne/LatestChooseOne/src/screens/QuestionCategory.js"],"names":["React","useEffect","useState","Fragment","Helmet","InfiniteScroll","makeStyles","createStyles","QuestionList","getApps","initializeApp","getFirestore","collection","query","where","getDocs","orderBy","limit","startAfter","firebaseConfig","apiKey","authDomain","databaseURL","projectId","storageBucket","messagingSenderId","appId","measurementId","db","length","firebaseApp","QuestionCategory","props","questions","setQuestions","hasMore","setHasMore","end","setEnd","last","setLast","category","match","params","styles","useStyles","q","promise","Promise","resolve","reject","then","qq","ques","all","docs","map","doc","push","data","loadMore","page","more","next","concat","name","content","title","fontFamily","fontStyle","fontWeight","fontSize","marginLeft","marginTop"],"mappings":"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","sourcesContent":["import React, { useEffect, useState, Fragment } from 'react';\nimport { Helmet } from \"react-helmet\";\nimport InfiniteScroll  from \"react-infinite-scroller\"\nimport { makeStyles, createStyles } from '@material-ui/core';\n\nimport QuestionList from '../components/QuestionList.js';\n\n// Firebase\nimport { getApps, initializeApp } from 'firebase/app';\nimport { getFirestore, collection, query, where, getDocs, orderBy, limit, startAfter } from \"firebase/firestore\";\nconst firebaseConfig = {\n  apiKey: \"AIzaSyArjDv3hS4_rw1YyNz-JFXDX1ufF72bqr8\",\n  authDomain: \"chooseone-105a9.firebaseapp.com\",\n  databaseURL: \"https://chooseone-default-rtdb.firebaseio.com\",\n  projectId: \"chooseone\",\n  storageBucket: \"chooseone.appspot.com\",\n  messagingSenderId: \"722704825746\",\n  appId: \"1:722704825746:web:73f11551b9e59f4bc2d54b\",\n  measurementId: \"G-YJ97DZH6V5\"\n};\nvar db = '';\nif (!getApps().length){ \n  const firebaseApp = initializeApp(firebaseConfig);\n  db = getFirestore(firebaseApp);\n}else{\n  db = getFirestore();\n}\n\nexport default function QuestionCategory (props) {\n\n  const [questions, setQuestions] = useState([]);\n  const [hasMore, setHasMore] = useState(true);\n  const [end, setEnd] = useState(null);\n  const [last, setLast] = useState(null);\n  const category = props.match.params.category;\n  const styles = useStyles();\n\n  useEffect(() => {\n    if(questions.length !== 0) return null;\n\n    const q = query(collection(db, 'questions'), where('category', 'array-contains', category), orderBy('created_at', 'desc'), limit(10));\n    const promise = new Promise(function(resolve, reject) {\n      resolve(getDocs(q));\n    });\n    promise.then((qq) => {\n      var ques = [];\n      Promise.all(qq.docs.map(async doc => {\n        ques.push(doc.data());\n        if(ques.length === 10) setLast(doc);\n      })).then(() => {\n        setQuestions(ques);\n      })\n    });\n\n    if(end === null){\n      setEnd(query(collection(db, 'questions'), where('category', 'array-contains', category), orderBy('created_at', 'asc'), limit(1)));\n    }\n  });\n\n  const loadMore = async (page) => {\n    var more = true;\n    setHasMore(false);\n\n    const next = await getDocs(query(collection(db, 'questions'), where('category', 'array-contains', category), orderBy('created_at', 'desc'), startAfter(last), limit(10)));\n    var ques = [];\n    await Promise.all(next.docs.map(async doc => {\n      ques.push(doc.data());\n      if(doc === end || ques.length === 10) {\n        if(doc === end) more = false;\n        setLast(doc);\n      }\n    })).then(() => setQuestions(questions.concat(ques)));\n\n    if(more) setHasMore(true);\n    else setHasMore(false);\n  }\n\n  return (\n    <Fragment>\n      <Helmet\n        title = {'Questions Categorized as ' + category}\n        meta={[\n          { name: 'description', content: 'ChooseOne lets you have access to general understandings through user-interactive questions. The more you vote, the more you can influence the results, and it can be helpful to all the people who want to know the results.' }\n        ]}\n      />\n      <p className={styles.title}>Questions Categorized as {category}</p>\n      <InfiniteScroll\n        loadMore={loadMore}\n        hasMore={hasMore}\n        threshold={500}\n        loader={<div></div> }\n      >\n        <QuestionList questions={questions} />\n      </InfiniteScroll>\n    </Fragment>\n  )\n}\n\nconst useStyles = makeStyles(() => createStyles({\n  title: {\n    fontFamily: 'lust-script, sans-serif',\n    fontStyle: 'normal',\n    fontWeight: 700,\n    fontSize: 24,\n  },\n\n  '@media (max-width: 500px)': {\n    title: {\n      fontSize: 22,\n      marginLeft: 15,\n      marginTop: 7,\n    }\n  }\n}));\n\n"]},"metadata":{},"sourceType":"module"}