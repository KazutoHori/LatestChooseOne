{"ast":null,"code":"import _regeneratorRuntime from\"/Users/horikazuto/ChooseOne/LatestChooseOne/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"/Users/horikazuto/ChooseOne/LatestChooseOne/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _slicedToArray from\"/Users/horikazuto/ChooseOne/LatestChooseOne/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React,{useState,Fragment}from'react';import{slugify,timeToDay}from'../utils/Funcs.js';import Button from'@material-ui/core/Button';import ButtonGroup from'@material-ui/core/ButtonGroup';import PostAddIcon from'@material-ui/icons/PostAdd';import AddIcon from'@material-ui/icons/Add';import{createMuiTheme,ThemeProvider,withStyles}from'@material-ui/core/styles';import Input from'@material-ui/core/Input';import InputAdornment from'@material-ui/core/InputAdornment';import DeleteIcon from'@material-ui/icons/Delete';import IconButton from'@material-ui/core/IconButton';import Tooltip from'@material-ui/core/Tooltip';import{makeStyles,createStyles}from'@material-ui/core';import useMediaQuery from'@material-ui/core/useMediaQuery';import{WindMillLoading}from'react-loadingg';import{Helmet}from\"react-helmet\";// Firebase\nimport{getApps,initializeApp}from'firebase/app';import{getFirestore,arrayUnion,updateDoc,collection,query,where,getDocs,doc,setDoc}from\"firebase/firestore\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var firebaseConfig={apiKey:\"AIzaSyArjDv3hS4_rw1YyNz-JFXDX1ufF72bqr8\",authDomain:\"chooseone-105a9.firebaseapp.com\",databaseURL:\"https://chooseone-default-rtdb.firebaseio.com\",projectId:\"chooseone\",storageBucket:\"chooseone.appspot.com\",messagingSenderId:\"722704825746\",appId:\"1:722704825746:web:73f11551b9e59f4bc2d54b\",measurementId:\"G-YJ97DZH6V5\"};var db='';if(!getApps().length){var firebaseApp=initializeApp(firebaseConfig);db=getFirestore(firebaseApp);}else{db=getFirestore();}var allCategories=['Love','News','Sports','Pastime','Health','Living','Career','Academics','IT'];var tabColors=['#ff69b4'];for(var i=1;i<11;i++){tabColors.push('hsla('+i*100+', 75%, 55%, 1)');}export default function QuestionCreate(props){var uid=localStorage.getItem('chooseoneUid');var _useState=useState([]),_useState2=_slicedToArray(_useState,2),categories=_useState2[0],setCategories=_useState2[1];var _useState3=useState(2),_useState4=_slicedToArray(_useState3,2),howManyChoice=_useState4[0],setHowManyChoice=_useState4[1];var _useState5=useState(''),_useState6=_slicedToArray(_useState5,2),warning=_useState6[0],setWarning=_useState6[1];var _useState7=useState(''),_useState8=_slicedToArray(_useState7,2),title=_useState8[0],setTitle=_useState8[1];var _useState9=useState([]),_useState10=_slicedToArray(_useState9,2),choices=_useState10[0],setChoices=_useState10[1];var _useState11=useState(false),_useState12=_slicedToArray(_useState11,2),voting=_useState12[0],setVoting=_useState12[1];var added=[];var styles=useStyles();var smallDisplay=useMediaQuery('(max-width:500px)');// const [user, setUser] = useRecoilState(userAtom);\nvar theme=createMuiTheme({palette:{primary:{main:'rgb(3, 122, 255)'},secondary:{main:'#f50057'},green:{main:'rgb(40, 168, 69)'}}});var onSubmit=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){var ifSuperUser,likes,finalTitle,S,totalVotes,new_choices,i,text,votes,how_many,slug,rep,sameQ,conc,now_slug,_sameQ,current,day,new_question;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:if(!(title==='')){_context.next=4;break;}setWarning('Title cannot be empty.');setTimeout(function(){return setWarning('');},5000);return _context.abrupt(\"return\",null);case 4:ifSuperUser=title.slice(0,5)==='SUQ__';likes=0;if(!ifSuperUser){_context.next=15;break;}if('0123456789'.includes(title[title.length-2])){_context.next=11;break;}setWarning('Likesの入力を忘れてるよ');setTimeout(function(){return setWarning('');},5000);return _context.abrupt(\"return\",null);case 11:likes=parseInt(title.slice(-2),10);finalTitle=title.slice(5).slice(0,-2);_context.next=16;break;case 15:finalTitle=title;case 16:S=new Set(choices);if(!(choices.length!==S.size)){_context.next=21;break;}setWarning('There are same choices.');setTimeout(function(){return setWarning('');},5000);return _context.abrupt(\"return\",null);case 21:totalVotes=0;new_choices=[];i=0;case 24:if(!(i<howManyChoice)){_context.next=43;break;}if(!(choices[i]===undefined||choices[i]==='')){_context.next=31;break;}setWarning('There is an empty choice.');setTimeout(function(){return setWarning('');},5000);return _context.abrupt(\"return\",null);case 31:text=ifSuperUser?choices[i].slice(0,-3):choices[i];votes=ifSuperUser?choices[i].slice(-3):0;if(!(ifSuperUser&&!'0123456789'.includes(votes[0]))){_context.next=37;break;}setWarning('選択肢の最後の数字忘れてる');setTimeout(function(){return setWarning('');},5000);return _context.abrupt(\"return\",null);case 37:if(votes[0]==='0')votes=votes[1]+votes[2];totalVotes+=parseInt(votes,10);new_choices.push({choice_text:text,votes:parseInt(votes,10)});case 40:i++;_context.next=24;break;case 43:if(!(categories.length===0)){_context.next=47;break;}setWarning('Category cannot be empty.');setTimeout(function(){return setWarning('');},5000);return _context.abrupt(\"return\",null);case 47:setVoting(true);_context.next=50;return getDocs(query(collection(db,'questions')));case 50:how_many=_context.sent;how_many=how_many.docs.length;slug=slugify(finalTitle);if(slug==='')slug=finalTitle;rep=0;_context.next=57;return getDocs(query(collection(db,'questions'),where('slug','==',slug)));case 57:sameQ=_context.sent;rep=sameQ.docs.length;case 59:if(!(rep!==0)){_context.next=69;break;}rep=rep+1;conc='___'.concat(rep);now_slug=slug.concat(conc);_context.next=65;return getDocs(query(collection(db,'questions'),where('slug','==',now_slug)));case 65:_sameQ=_context.sent;if(_sameQ.docs.length===0){slug=now_slug;rep=0;}_context.next=59;break;case 69:current=new Date();current=current.toJSON();day=timeToDay(current.slice(0,10));new_question={id:how_many+1,title:finalTitle,author:uid,category:categories,slug:slug,created_on:day,created_at:current.slice(0,10)+' '+current.slice(11,19),choices:new_choices,comments:[],users_voted:[],all_votes:totalVotes,active:true,likes:likes,SUQ:ifSuperUser};_context.next=75;return setDoc(doc(db,'questions',slug),new_question);case 75:_context.next=77;return updateDoc(doc(db,'users',uid),{question_created:arrayUnion(slug)});case 77:window.location.href=\"/q/\"+slug;case 78:case\"end\":return _context.stop();}}},_callee);}));return function onSubmit(){return _ref.apply(this,arguments);};}();var titleChangeText=function titleChangeText(event){setTitle(event.target.value);};var choiceChangeText=function choiceChangeText(event,idx){var copy=choices.slice();copy[idx]=event.target.value;setChoices(copy);};var onCategory=function onCategory(idx){var copy=categories.slice();if(copy.includes(allCategories[idx])){copy=copy.filter(function(c){return c!==allCategories[idx];});}else{copy.push(allCategories[idx]);}setCategories(copy);};var onChoiceDelete=function onChoiceDelete(i){var copy=choices.slice();copy.splice(i,1);setChoices(copy);setHowManyChoice(howManyChoice-1);};var added=[];var _loop=function _loop(_i){added.push(/*#__PURE__*/_jsx(\"div\",{className:styles.choicePos,children:/*#__PURE__*/_jsx(Input,{id:\"standard-adornment-weight\",autoComplete:false,value:choices[_i]?choices[_i]:'',className:styles.choiceInput,onChange:function onChange(event){return choiceChangeText(event,_i);},startAdornment:/*#__PURE__*/_jsxs(InputAdornment,{position:\"start\",children:[_i+1,\". \"]}),endAdornment:_i>1&&/*#__PURE__*/_jsx(InputAdornment,{position:\"end\",children:/*#__PURE__*/_jsx(Tooltip,{title:\"Delete\",children:/*#__PURE__*/_jsx(IconButton,{\"aria-label\":\"delete\",style:{outline:'none'},onClick:function onClick(){return onChoiceDelete(_i);},color:\"secondary\",children:/*#__PURE__*/_jsx(DeleteIcon,{})})})}),\"aria-describedby\":\"standard-weight-helper-text\",inputProps:{'aria-label':'weight'}})}));};for(var _i=0;_i<howManyChoice;_i++){_loop(_i);}return/*#__PURE__*/_jsxs(Fragment,{children:[/*#__PURE__*/_jsx(Helmet,{title:\"Add New Questions\",meta:[{name:'description',content:'ChooseOne lets you have access to general understandings through user-interactive questions. The more you vote, the more you can influence the results, and it can be helpful to all the people who want to know the results.'}]}),/*#__PURE__*/_jsxs(\"div\",{className:styles.add,children:[/*#__PURE__*/_jsx(\"h3\",{className:styles.title,children:\"Let's Add New Questions!\"}),/*#__PURE__*/_jsx(\"h4\",{className:styles.labels,children:\"Title\"}),/*#__PURE__*/_jsx(Input,{id:\"standard-adornment-weight\",autoComplete:false,className:styles.titleInput,onChange:function onChange(event){return titleChangeText(event);},value:title,\"aria-describedby\":\"standard-weight-helper-text\",startAdornment:/*#__PURE__*/_jsx(InputAdornment,{position:\"start\",children:\"Q. \"}),inputProps:{'aria-label':'weight'}}),/*#__PURE__*/_jsx(\"h4\",{className:styles.labels,children:\"Choices\"}),/*#__PURE__*/_jsx(\"div\",{children:howManyChoice!==0&&[added]}),/*#__PURE__*/_jsx(\"div\",{children:/*#__PURE__*/_jsx(ThemeProvider,{theme:theme,children:/*#__PURE__*/_jsx(ButtonGroup,{size:smallDisplay?'small':'default',disableElevation:true,variant:\"contained\",children:howManyChoice<9&&/*#__PURE__*/_jsx(StyledButton,{startIcon:/*#__PURE__*/_jsx(AddIcon,{}),color:\"primary\",onClick:function onClick(){return setHowManyChoice(howManyChoice+1);},children:\"Add\"})})})}),/*#__PURE__*/_jsx(\"div\",{className:styles.cateTitle,children:/*#__PURE__*/_jsx(\"h4\",{className:styles.labels,children:\"Category\"})}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"div\",{children:allCategories.map(function(cate,idx){if(idx>=3)return null;if(categories.includes(allCategories[idx]))var changer={backgroundColor:tabColors[idx],color:'white'};else{var changer={backgroundColor:'white',color:tabColors[idx]};}return/*#__PURE__*/_jsx(Fragment,{children:/*#__PURE__*/_jsx(\"button\",{onClick:function onClick(){return onCategory(idx);},type:\"button\",\"data-id\":idx,style:Object.assign({borderColor:tabColors[idx],outline:'none'},changer),className:styles.cate,children:cate})});})}),/*#__PURE__*/_jsx(\"div\",{children:allCategories.map(function(cate,idx){if(idx<=2||idx>=6)return null;if(categories.includes(allCategories[idx]))var changer={backgroundColor:tabColors[idx],color:'white'};else{var changer={backgroundColor:'white',color:tabColors[idx]};}return/*#__PURE__*/_jsx(Fragment,{children:/*#__PURE__*/_jsx(\"button\",{onClick:function onClick(){return onCategory(idx);},type:\"button\",\"data-id\":idx,style:Object.assign({borderColor:tabColors[idx],outline:'none'},changer),className:styles.cate,children:cate})});})}),/*#__PURE__*/_jsx(\"div\",{children:allCategories.map(function(cate,idx){if(idx<=5)return null;if(categories.includes(allCategories[idx]))var changer={backgroundColor:tabColors[idx],color:'white'};else{var changer={backgroundColor:'white',color:tabColors[idx]};}return/*#__PURE__*/_jsx(Fragment,{children:/*#__PURE__*/_jsx(\"button\",{onClick:function onClick(){return onCategory(idx);},type:\"button\",\"data-id\":idx,style:Object.assign({borderColor:tabColors[idx],outline:'none'},changer),className:styles.cate,children:cate})});})})]}),warning&&/*#__PURE__*/_jsx(\"p\",{style:{color:'red'},className:styles.warning,children:warning}),!warning&&/*#__PURE__*/_jsx(\"p\",{className:styles.warning,children:\"You can delete but cannot edit after you make one.\"}),!voting?/*#__PURE__*/_jsx(ThemeProvider,{theme:theme,children:/*#__PURE__*/_jsx(ButtonGroup,{disableElevation:true,variant:\"contained\",children:/*#__PURE__*/_jsx(StyledButton,{style:{fontSize:11,outline:'none',backgroundColor:'rgb(40, 168, 69)'},size:\"small\",startIcon:/*#__PURE__*/_jsx(PostAddIcon,{}),onClick:onSubmit,children:\"Add Question\"})})}):/*#__PURE__*/_jsx(\"div\",{className:styles.loadingPos,children:/*#__PURE__*/_jsx(WindMillLoading,{speed:1.2})})]})]});}var useStyles=makeStyles(function(){return createStyles({loadingPos:{marginTop:50,// marginLeft: 50,\nposition:'relative'},labels:{fontFamily:'latienne-pro, serif',fontStyle:'normal',fontWeight:400},title:{fontFamily:'lust-script, sans-serif',fontStyle:'normal',fontWeight:700},cateTitle:{marginTop:25,marginBottom:20},warning:{marginTop:20,fontSize:12},titleInput:{width:'70%',marginBottom:20,borderColor:'#617',borderWidth:1},add:{backgroundColor:'white',height:'auto',textAlign:'center',filter:'drop-shadow(0px 0px 5px rgba(160, 160, 160, 0.7))',padding:10,paddingBottom:50,borderRadius:15},cate:{fontSize:5,marginBottom:10,marginRight:10,textAlign:'center',width:70,height:25,paddingLeft:2,paddingRight:2,cursor:'pointer',borderWidth:1,borderStyle:'solid',borderRadius:25},choicePos:{marginBottom:15},choiceInput:{width:'50%'},'@media (max-width: 500px)':{cate:{fontSize:12},labels:{fontSize:20,marginTop:20},titleInput:{width:'90%'},choiceInput:{width:'80%'},cateTitle:{marginTop:20,marginBottom:10}}});});var StyledButton=withStyles({root:{// background: 'linear-gradient(45deg, #FE6B8B 30%, #FF8E53 90%)',\nborderRadius:4,fontSize:12,color:'white',height:30,padding:'0 15px',outline:'none',boxShadow:'0 3px 5px 2px rgba(255, 105, 135, .3)'},cate:{textTransform:'capitalize'}})(Button);","map":{"version":3,"sources":["/Users/horikazuto/ChooseOne/LatestChooseOne/src/screens/QuestionCreate.js"],"names":["React","useState","Fragment","slugify","timeToDay","Button","ButtonGroup","PostAddIcon","AddIcon","createMuiTheme","ThemeProvider","withStyles","Input","InputAdornment","DeleteIcon","IconButton","Tooltip","makeStyles","createStyles","useMediaQuery","WindMillLoading","Helmet","getApps","initializeApp","getFirestore","arrayUnion","updateDoc","collection","query","where","getDocs","doc","setDoc","firebaseConfig","apiKey","authDomain","databaseURL","projectId","storageBucket","messagingSenderId","appId","measurementId","db","length","firebaseApp","allCategories","tabColors","i","push","QuestionCreate","props","uid","localStorage","getItem","categories","setCategories","howManyChoice","setHowManyChoice","warning","setWarning","title","setTitle","choices","setChoices","voting","setVoting","added","styles","useStyles","smallDisplay","theme","palette","primary","main","secondary","green","onSubmit","setTimeout","ifSuperUser","slice","likes","includes","parseInt","finalTitle","S","Set","size","totalVotes","new_choices","undefined","text","votes","choice_text","how_many","docs","slug","rep","sameQ","conc","concat","now_slug","current","Date","toJSON","day","new_question","id","author","category","created_on","created_at","comments","users_voted","all_votes","active","SUQ","question_created","window","location","href","titleChangeText","event","target","value","choiceChangeText","idx","copy","onCategory","filter","c","onChoiceDelete","splice","choicePos","choiceInput","outline","name","content","add","labels","titleInput","cateTitle","map","cate","changer","backgroundColor","color","Object","assign","borderColor","fontSize","loadingPos","marginTop","position","fontFamily","fontStyle","fontWeight","marginBottom","width","borderWidth","height","textAlign","padding","paddingBottom","borderRadius","marginRight","paddingLeft","paddingRight","cursor","borderStyle","StyledButton","root","boxShadow","textTransform"],"mappings":"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","sourcesContent":["import React, { useState, Fragment } from 'react';\nimport { slugify, timeToDay } from '../utils/Funcs.js';\nimport Button from '@material-ui/core/Button';\nimport ButtonGroup from '@material-ui/core/ButtonGroup';\nimport PostAddIcon from '@material-ui/icons/PostAdd';\nimport AddIcon from '@material-ui/icons/Add';\nimport { createMuiTheme, ThemeProvider, withStyles } from '@material-ui/core/styles';\nimport Input from '@material-ui/core/Input';\nimport InputAdornment from '@material-ui/core/InputAdornment';\nimport DeleteIcon from '@material-ui/icons/Delete';\nimport IconButton from '@material-ui/core/IconButton';\nimport Tooltip from '@material-ui/core/Tooltip';\nimport { makeStyles, createStyles } from '@material-ui/core';\nimport useMediaQuery from '@material-ui/core/useMediaQuery';\nimport { WindMillLoading } from 'react-loadingg';\nimport { Helmet } from \"react-helmet\";\n\n// Firebase\nimport { getApps, initializeApp } from 'firebase/app';\nimport { getFirestore, arrayUnion, updateDoc, collection, query, where, getDocs, doc, setDoc } from \"firebase/firestore\";\nconst firebaseConfig = {\n  apiKey: \"AIzaSyArjDv3hS4_rw1YyNz-JFXDX1ufF72bqr8\",\n  authDomain: \"chooseone-105a9.firebaseapp.com\",\n  databaseURL: \"https://chooseone-default-rtdb.firebaseio.com\",\n  projectId: \"chooseone\",\n  storageBucket: \"chooseone.appspot.com\",\n  messagingSenderId: \"722704825746\",\n  appId: \"1:722704825746:web:73f11551b9e59f4bc2d54b\",\n  measurementId: \"G-YJ97DZH6V5\"\n};\nvar db = '';\nif (!getApps().length){ \n  const firebaseApp = initializeApp(firebaseConfig);\n  db = getFirestore(firebaseApp);\n}else{\n  db = getFirestore();\n}\n\nvar allCategories = ['Love', 'News', 'Sports', 'Pastime', 'Health', 'Living', 'Career', 'Academics', 'IT'];\nvar tabColors = ['#ff69b4']\nfor(var i=1; i<11; i++) tabColors.push('hsla('+(i*100)+', 75%, 55%, 1)');\n\nexport default function QuestionCreate (props) {\n\n  const uid = localStorage.getItem('chooseoneUid');\n  const [categories, setCategories] = useState([]);\n  const [howManyChoice, setHowManyChoice] = useState(2);\n  const [warning, setWarning] = useState('');\n  const [title, setTitle] = useState('');\n  const [choices, setChoices] = useState([]);\n  const [voting, setVoting] = useState(false);\n  var added=[];\n  const styles = useStyles();\n  const smallDisplay = useMediaQuery('(max-width:500px)');\n  // const [user, setUser] = useRecoilState(userAtom);\n  const theme = createMuiTheme({\n    palette: {\n      primary: {\n        main: 'rgb(3, 122, 255)',\n      },\n      secondary: {\n        main: '#f50057',\n      },\n      green: {\n        main: 'rgb(40, 168, 69)',\n      }\n    },\n  });\n\n  const onSubmit = async () => {\n\n    if(title === ''){\n      setWarning('Title cannot be empty.');\n      setTimeout(() => setWarning(''),5000);\n      return null;\n    }\n    var ifSuperUser = title.slice(0, 5) === 'SUQ__';\n    var likes = 0;\n    if(ifSuperUser){\n      if(!'0123456789'.includes(title[title.length-2])){\n        setWarning('Likesの入力を忘れてるよ');\n        setTimeout(() => setWarning(''),5000);\n        return null;\n      }\n      likes = parseInt(title.slice(-2), 10);\n      var finalTitle = title.slice(5).slice(0, -2);\n    } else var finalTitle = title;\n    \n    var S = new Set(choices);\n    if(choices.length !== S.size) {\n      setWarning('There are same choices.');\n      setTimeout(() => setWarning(''),5000);\n      return null;\n    }\n\n    var totalVotes = 0;\n    let new_choices = [];\n    for(var i=0; i<howManyChoice; i++){\n      if(choices[i] === undefined || choices[i] === ''){\n        setWarning('There is an empty choice.');\n        setTimeout(() => setWarning(''),5000);\n        return null;\n      }else{\n        var text = ifSuperUser ? choices[i].slice(0, -3) : choices[i];\n        var votes = ifSuperUser ? choices[i].slice(-3) : 0;\n        if(ifSuperUser && !'0123456789'.includes(votes[0])){\n          setWarning('選択肢の最後の数字忘れてる');\n          setTimeout(() => setWarning(''),5000);\n          return null;\n        }\n        if(votes[0] === '0') votes = votes[1] + votes[2];\n        totalVotes += parseInt(votes, 10);\n        new_choices.push({\n          choice_text: text,\n          votes: parseInt(votes, 10),\n        });\n      }\n    }\n\n    if(categories.length === 0){\n      setWarning('Category cannot be empty.');\n      setTimeout(() => setWarning(''),5000);\n      return null;\n    }\n\n    setVoting(true);\n\n    var how_many = await getDocs(query(collection(db, 'questions')));\n    how_many = how_many.docs.length;\n\n    var slug=slugify(finalTitle);\n    if(slug === '') slug=finalTitle;\n\n    var rep=0;\n\n    const sameQ = await getDocs(query(collection(db, 'questions'), where('slug', '==', slug)));\n    rep = sameQ.docs.length;\n\n    while(rep !== 0) {\n      rep=rep+1;\n      var conc = '___'.concat(rep);\n      var now_slug=slug.concat(conc);\n      \n      const sameQ = await getDocs(query(collection(db, 'questions'), where('slug', '==', now_slug)));\n      if(sameQ.docs.length === 0){\n        slug = now_slug;\n        rep = 0;\n      }\n    }\n\n    let current=new Date();\n    current=current.toJSON();\n    var day = timeToDay(current.slice(0, 10));\n    var new_question = {\n      id: how_many+1,\n      title: finalTitle,\n      author: uid,\n      category: categories,\n      slug: slug,\n      created_on: day,\n      created_at: current.slice(0, 10)+' '+current.slice(11, 19),\n      choices: new_choices,\n      comments: [],\n      users_voted: [],\n      all_votes: totalVotes,\n      active: true,\n      likes: likes,\n      SUQ: ifSuperUser,\n    }\n\n    await setDoc(doc(db, 'questions', slug), new_question);\n\n    await updateDoc(doc(db, 'users', uid), {\n      question_created: arrayUnion(slug),\n    });\n\n    window.location.href = \"/q/\" + slug;\n  };\n\n  const titleChangeText = (event) => {\n    setTitle(event.target.value);\n  };\n\n  const choiceChangeText = (event, idx) => {\n    var copy = choices.slice();\n    copy[idx] = event.target.value;\n\n    setChoices(copy);\n  };\n\n  const onCategory = (idx) => {\n    var copy=categories.slice();\n    if(copy.includes(allCategories[idx])){\n      copy=copy.filter(c => c !== allCategories[idx]);\n    }else{\n      copy.push(allCategories[idx]);\n    }\n    setCategories(copy);\n  }\n\n  const onChoiceDelete = (i) => {\n    var copy = choices.slice();\n    copy.splice(i, 1);\n    setChoices(copy);\n    setHowManyChoice(howManyChoice-1);\n  }\n\n  var added = [];\n  for (let i=0; i<howManyChoice; i++){\n    added.push(\n      <div className={styles.choicePos}>\n        <Input\n          id=\"standard-adornment-weight\"\n          autoComplete={false}\n          value={choices[i] ? choices[i] : ''}\n          className={styles.choiceInput}\n          onChange={(event) => choiceChangeText(event, i)}\n          startAdornment={<InputAdornment position=\"start\">{i+1}. </InputAdornment>}\n          endAdornment={i > 1 && <InputAdornment position=\"end\"><Tooltip title='Delete'><IconButton aria-label=\"delete\" style={{ outline: 'none', }} onClick={() => onChoiceDelete(i)} color='secondary'><DeleteIcon /></IconButton></Tooltip></InputAdornment>}\n          aria-describedby=\"standard-weight-helper-text\"\n          inputProps={{\n            'aria-label': 'weight',\n          }}\n        />\n      </div>\n    );\n  }\n\n  return (\n    <Fragment>\n      <Helmet\n        title = 'Add New Questions'\n        meta={[\n          { name: 'description', content: 'ChooseOne lets you have access to general understandings through user-interactive questions. The more you vote, the more you can influence the results, and it can be helpful to all the people who want to know the results.' }\n        ]}\n      />\n      <div className={styles.add}>\n        <h3 className={styles.title}>Let's Add New Questions!</h3>\n        \n        {/* タイトル */}\n        <h4 className={styles.labels}>Title</h4>\n        <Input\n          id=\"standard-adornment-weight\"\n          autoComplete={false}\n          className={styles.titleInput}\n          onChange={(event) => titleChangeText(event)}\n          value={title}\n          aria-describedby=\"standard-weight-helper-text\"\n          startAdornment={<InputAdornment position=\"start\">Q. </InputAdornment>}\n          inputProps={{\n            'aria-label': 'weight',\n          }}\n        />\n\n\n        {/* 選択肢 */}\n        <h4 className={styles.labels}>Choices</h4>\n        <div>\n          {howManyChoice !== 0 && (\n            [added]\n          )}\n        </div>\n\n        {/* ボタン */}\n        <div>\n          <ThemeProvider theme={theme}>\n            <ButtonGroup size={smallDisplay ? 'small' : 'default'} disableElevation variant=\"contained\" >\n              {howManyChoice < 9 && <StyledButton startIcon={<AddIcon /> } color='primary' onClick={() => setHowManyChoice(howManyChoice+1) } >Add</StyledButton>}\n            </ButtonGroup>\n          </ThemeProvider>\n        </div>\n\n        {/* カテゴリー */}\n        <div className={styles.cateTitle}>\n          <h4 className={styles.labels}>Category</h4>\n        </div>\n        <div>\n          <div>\n            {allCategories.map((cate, idx) => {\n              if (idx >= 3) return null;\n              if (categories.includes(allCategories[idx])) var changer = { backgroundColor: tabColors[idx], color: 'white'  }\n              else { var changer = { backgroundColor: 'white', color: tabColors[idx] } }\n              return (\n                <Fragment>\n                  <button onClick={() => onCategory(idx) } type='button' data-id={idx} style={Object.assign({ borderColor: tabColors[idx], outline: 'none'}, changer)} className={styles.cate}  >{cate}</button>\n                </Fragment>\n              )\n            })}\n          </div>\n          <div>\n            {allCategories.map((cate, idx) => {\n              if (idx <= 2 || idx >= 6) return null;\n              if (categories.includes(allCategories[idx])) var changer = { backgroundColor: tabColors[idx], color: 'white'  }\n              else { var changer = { backgroundColor: 'white', color: tabColors[idx] } }\n              return (\n                <Fragment>\n                  <button onClick={() => onCategory(idx) } type='button' data-id={idx} style={Object.assign({ borderColor: tabColors[idx], outline: 'none'}, changer)} className={styles.cate} >{cate}</button>\n                </Fragment>\n              )\n            })}\n          </div>\n          <div>\n            {allCategories.map((cate, idx) => {\n              if (idx <= 5) return null;\n              if (categories.includes(allCategories[idx])) var changer = { backgroundColor: tabColors[idx], color: 'white'  }\n              else { var changer = { backgroundColor: 'white', color: tabColors[idx] } }\n              return (\n                <Fragment>\n                  <button onClick={() => onCategory(idx) } type='button' data-id={idx} style={Object.assign({ borderColor: tabColors[idx], outline: 'none'}, changer)} className={styles.cate}  >{cate}</button>\n                </Fragment>\n              )\n            })}\n          </div>\n        </div>\n        {/* 最後 */}\n        {warning && <p style={{color: 'red' }} className={styles.warning} >{warning}</p>}\n        {!warning && <p className={styles.warning}>You can delete but cannot edit after you make one.</p>}\n        {!voting\n          ?\n          <ThemeProvider theme={theme}>\n            <ButtonGroup disableElevation variant=\"contained\" >\n              <StyledButton style={{ fontSize: 11, outline: 'none', backgroundColor: 'rgb(40, 168, 69)' }} size='small' startIcon={<PostAddIcon /> } onClick={onSubmit} >Add Question</StyledButton>\n            </ButtonGroup>\n          </ThemeProvider>\n          :\n          <div className={styles.loadingPos}>\n            <WindMillLoading speed={1.2}  />\n          </div>\n        }\n      </div>\n    </Fragment>\n  )\n}\n\nconst useStyles = makeStyles(() => createStyles({\n  loadingPos: {\n    marginTop: 50,\n    // marginLeft: 50,\n    position: 'relative',\n  },\n  labels: {\n    fontFamily: 'latienne-pro, serif',\n    fontStyle: 'normal',\n    fontWeight: 400,\n  },\n  title: {\n    fontFamily: 'lust-script, sans-serif',\n    fontStyle: 'normal',\n    fontWeight: 700,\n  },\n  cateTitle: {\n    marginTop: 25,\n    marginBottom: 20,\n  },\n  warning: {\n    marginTop: 20,\n    fontSize: 12,\n  },\n  titleInput: {\n    width: '70%',\n    marginBottom: 20,\n    borderColor: '#617',\n    borderWidth: 1,\n  },\n  add: {\n    backgroundColor: 'white',\n    height: 'auto',\n    textAlign: 'center',\n    filter: 'drop-shadow(0px 0px 5px rgba(160, 160, 160, 0.7))',\n    padding: 10,\n    paddingBottom: 50,\n    borderRadius: 15,\n  },\n  cate: {\n    fontSize: 5,\n    marginBottom: 10,\n    marginRight: 10,\n    textAlign: 'center',\n    width: 70,\n    height: 25,\n    paddingLeft: 2,\n    paddingRight: 2,\n    cursor: 'pointer',\n    borderWidth: 1,\n    borderStyle: 'solid',\n    borderRadius: 25,\n  },\n  choicePos: {\n    marginBottom: 15,\n  },\n  choiceInput: {\n    width: '50%',\n  },\n  '@media (max-width: 500px)': {\n    cate: {\n      fontSize: 12,\n    },\n    labels: {\n      fontSize: 20,\n      marginTop: 20,\n    },\n    titleInput: {\n      width: '90%',\n    },\n    choiceInput: {\n      width: '80%',\n    },\n    cateTitle: {\n      marginTop: 20,\n      marginBottom: 10,\n    },\n  }\n}));\n\n\n\nconst StyledButton = withStyles({\n  root: {\n    // background: 'linear-gradient(45deg, #FE6B8B 30%, #FF8E53 90%)',\n    borderRadius: 4,\n    fontSize: 12,\n    color: 'white',\n    height: 30,\n    padding: '0 15px',\n    outline: 'none',\n    boxShadow: '0 3px 5px 2px rgba(255, 105, 135, .3)',\n  },\n  cate: {\n    textTransform: 'capitalize',\n  },\n})(Button);\n\n"]},"metadata":{},"sourceType":"module"}