{"ast":null,"code":"import _regeneratorRuntime from\"/Users/horikazuto/ChooseOne/LatestChooseOne/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"/Users/horikazuto/ChooseOne/LatestChooseOne/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _slicedToArray from\"/Users/horikazuto/ChooseOne/LatestChooseOne/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React,{Fragment,useState,useEffect}from'react';import Skeleton,{SkeletonTheme}from'react-loading-skeleton';import useMediaQuery from'@material-ui/core/useMediaQuery';import{makeStyles,createStyles}from'@material-ui/core';import{createMuiTheme,ThemeProvider,withStyles}from'@material-ui/core/styles';import ButtonGroup from'@material-ui/core/ButtonGroup';import Button from'@material-ui/core/Button';import{Bar}from'react-chartjs-2';import axios from\"axios\";import HoriChart from'./HoriChart';// Firebase\nimport{getApps,initializeApp}from'firebase/app';import{getFirestore,updateDoc,increment,collection,deleteDoc,startAfter,arrayRemove,arrayUnion,query,where,getDoc,doc,getDocs,orderBy,limit}from\"firebase/firestore\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var firebaseConfig={apiKey:\"AIzaSyArjDv3hS4_rw1YyNz-JFXDX1ufF72bqr8\",authDomain:\"chooseone-105a9.firebaseapp.com\",databaseURL:\"https://chooseone-default-rtdb.firebaseio.com\",projectId:\"chooseone\",storageBucket:\"chooseone.appspot.com\",messagingSenderId:\"722704825746\",appId:\"1:722704825746:web:73f11551b9e59f4bc2d54b\",measurementId:\"G-YJ97DZH6V5\"};var db='';if(!getApps().length){var firebaseApp=initializeApp(firebaseConfig);db=getFirestore(firebaseApp);}else{db=getFirestore();}export default function QuestionList(props){var theme=createMuiTheme({palette:{primary:{main:'rgb(3, 122, 255)'},secondary:{main:'#f50057'},green:{main:'rgb(40, 168, 69)'}}});var uid=localStorage.getItem('chooseoneUid');// const [your_vote, setYourVote] = useState(null);\nvar _useState=useState(false),_useState2=_slicedToArray(_useState,2),answered=_useState2[0],setAnswered=_useState2[1];var styles=useStyles();var l=[];var v=[];var c=[];var the_question=props.the_question;var notLoaded=the_question.category===null||the_question.category===undefined;var smallDisplay=useMediaQuery('(max-width:500px)');var choiceSkeleton=[];for(var i=0;i<5-smallDisplay*2;i++){choiceSkeleton.push(/*#__PURE__*/_jsx(\"div\",{children:/*#__PURE__*/_jsx(\"label\",{for:\"choice{idx}\",children:/*#__PURE__*/_jsx(Skeleton,{duration:2.5,width:150,height:10})})}));}if(the_question!=='skeleton'&&the_question!==undefined){var copy=the_question.choices;for(var _i=0;_i<copy.length;_i++){l.push(copy[_i].choice_text);v.push(copy[_i].votes);}var time=the_question.created_at;var seconds=parseInt(time.slice(-2));if(v!==[]){v.forEach(function(entry,idx){c.push('hsla('+(idx+seconds)*70+',75%,75%,1)');});}}useEffect(function(){if(uid===null)return null;// const u = doc(db, 'users', uid);\n// const promise = new Promise(function(resolve) {\n//   resolve(getDoc(u));\n// })\n// promise.then((us) => {\n//   if(us.exists){\n//     var the_user = us.data();\n//     if(the_user.question_voted.some((q) => q.question === the_question.slug)){\n//       setAnswered(true);\n//     }\n//   }\n// });\n});var onChoice=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(idx){var the_slug,your_vote,copy;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:the_slug=the_question.slug;your_vote=the_question.choices[idx].choice_text;setAnswered(true);copy=Object.create(the_question);copy.choices[idx].votes=parseInt(copy.choices[idx].votes,10)+1;_context.next=7;return updateDoc(doc(db,'questions',the_question.slug),{choices:copy.choices,all_votes:increment(1),users_voted:arrayUnion(uid)});case 7:_context.next=9;return updateDoc(doc(db,'users',uid),{question_voted:arrayUnion({question:the_slug,answer:your_vote})});case 9:case\"end\":return _context.stop();}}},_callee);}));return function onChoice(_x){return _ref.apply(this,arguments);};}();return/*#__PURE__*/_jsx(Fragment,{children:/*#__PURE__*/_jsxs(\"div\",{className:styles.onepost,children:[/*#__PURE__*/_jsxs(\"p\",{className:\"cali2\",style:{fontSize:12},children:[/*#__PURE__*/_jsx(\"span\",{className:\"text-primary fa fa-tag\"}),\"Category:\",!notLoaded&&/*#__PURE__*/_jsx(Fragment,{children:the_question.category.map(function(cate,idx){if(idx===0){return/*#__PURE__*/_jsxs(\"a\",{className:\"text-primary\",href:'/category/'+cate,children:[\" \",cate]});}else{return/*#__PURE__*/_jsxs(\"a\",{className:\"text-primary\",href:'/category/'+cate,children:[\", \",cate]});}})}),notLoaded&&/*#__PURE__*/_jsx(Skeleton,{style:{marginLeft:10},width:60})]}),/*#__PURE__*/_jsx(\"h4\",{style:{fontSize:19},className:\"cali2\",children:/*#__PURE__*/_jsx(\"a\",{className:styles.link,href:'/q/'+the_question.slug,children:!notLoaded?the_question.title:/*#__PURE__*/_jsx(SkeletonTheme,{color:\"white\",highlightColor:\"#d3d3d3\",children:/*#__PURE__*/_jsx(Skeleton,{duration:2.5,width:'80%',height:20})})})}),/*#__PURE__*/_jsx(\"div\",{className:styles.choices,style:{paddingLeft:smallDisplay&&answered&&0,paddingRight:!smallDisplay&&answered&&35},children:/*#__PURE__*/_jsxs(\"ul\",{style:{paddingLeft:0},children:[!notLoaded&&/*#__PURE__*/_jsx(Fragment,{children:!answered?/*#__PURE__*/_jsx(Fragment,{children:the_question.choices.map(function(choice,idx){return/*#__PURE__*/_jsx(\"div\",{children:/*#__PURE__*/_jsx(StyledButton,{variant:\"outlined\",onClick:function onClick(){return onChoice(idx);},size:\"small\",color:\"primary\",children:choice.choice_text})});})}):/*#__PURE__*/_jsx(Fragment,{children:/*#__PURE__*/_jsx(\"div\",{className:styles.HoriChart,children:/*#__PURE__*/_jsx(HoriChart,{small:smallDisplay,skeleton:notLoaded,labels:l,values:v,colors:c})})})}),notLoaded&&[choiceSkeleton]]})}),/*#__PURE__*/_jsx(\"div\",{className:styles.more,children:/*#__PURE__*/_jsx(ThemeProvider,{theme:theme,children:/*#__PURE__*/_jsx(ButtonGroup,{size:smallDisplay?'small':'default',disableElevation:true,variant:\"contained\",children:/*#__PURE__*/_jsx(Button,{variant:\"contained\",onClick:function onClick(){return window.location.href='/q/'+the_question.slug;},color:\"primary\",children:\"More\"})})})})]})});}var useStyles=makeStyles(function(){return createStyles({more:{marginBottom:10,marginLeft:12},onepost:{padding:10,paddingLeft:15,marginBottom:15,filter:'drop-shadow(0px 0px 5px rgba(160, 160, 160, 0.7))',backgroundColor:'white',position:'relative',borderRadius:15},choices:{paddingLeft:40},link:{color:'black','&:hover':{background:'linear-gradient(transparent 70%, #45cafb 0%)',textDecoration:'none'}},'@media (max-width: 500px)':{onepost:{borderRadius:0,marginBottom:5,paddingLeft:10,paddingBottom:1,filter:'none',link:{'&:hover':{background:'none'}}}}});});var StyledButton=withStyles({root:{borderRadius:7,borderColor:'#696969',borderWidth:0.1,color:'#696969',fontSize:11,width:Math.min(200,window.innerWidth*0.5),textTransform:'none',margin:2,paddingLeft:12,alignItems:'center',justifyContent:'start'},'@media (max-width: 500px)':{root:{width:window.innerWidth*0.5}}})(Button);","map":{"version":3,"sources":["/Users/horikazuto/ChooseOne/LatestChooseOne/src/components/Question.js"],"names":["React","Fragment","useState","useEffect","Skeleton","SkeletonTheme","useMediaQuery","makeStyles","createStyles","createMuiTheme","ThemeProvider","withStyles","ButtonGroup","Button","Bar","axios","HoriChart","getApps","initializeApp","getFirestore","updateDoc","increment","collection","deleteDoc","startAfter","arrayRemove","arrayUnion","query","where","getDoc","doc","getDocs","orderBy","limit","firebaseConfig","apiKey","authDomain","databaseURL","projectId","storageBucket","messagingSenderId","appId","measurementId","db","length","firebaseApp","QuestionList","props","theme","palette","primary","main","secondary","green","uid","localStorage","getItem","answered","setAnswered","styles","useStyles","l","v","c","the_question","notLoaded","category","undefined","smallDisplay","choiceSkeleton","i","push","copy","choices","choice_text","votes","time","created_at","seconds","parseInt","slice","forEach","entry","idx","onChoice","the_slug","slug","your_vote","Object","create","all_votes","users_voted","question_voted","question","answer","onepost","fontSize","map","cate","marginLeft","link","title","paddingLeft","paddingRight","choice","more","window","location","href","marginBottom","padding","filter","backgroundColor","position","borderRadius","color","background","textDecoration","paddingBottom","StyledButton","root","borderColor","borderWidth","width","Math","min","innerWidth","textTransform","margin","alignItems","justifyContent"],"mappings":"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","sourcesContent":["import React, { Fragment, useState, useEffect } from 'react';\nimport Skeleton, { SkeletonTheme } from 'react-loading-skeleton';\nimport useMediaQuery from '@material-ui/core/useMediaQuery';\nimport { makeStyles, createStyles } from '@material-ui/core';\nimport { createMuiTheme, ThemeProvider, withStyles } from '@material-ui/core/styles';\nimport ButtonGroup from '@material-ui/core/ButtonGroup';\nimport Button from '@material-ui/core/Button';\nimport { Bar } from 'react-chartjs-2';\nimport axios from \"axios\";\n\nimport HoriChart from './HoriChart';\n\n// Firebase\nimport { getApps, initializeApp } from 'firebase/app';\nimport { getFirestore, updateDoc, increment, collection, deleteDoc, startAfter, arrayRemove, arrayUnion, query, \n      where, getDoc, doc, getDocs, orderBy, limit } from \"firebase/firestore\";\nconst firebaseConfig = {\n  apiKey: \"AIzaSyArjDv3hS4_rw1YyNz-JFXDX1ufF72bqr8\",\n  authDomain: \"chooseone-105a9.firebaseapp.com\",\n  databaseURL: \"https://chooseone-default-rtdb.firebaseio.com\",\n  projectId: \"chooseone\",\n  storageBucket: \"chooseone.appspot.com\",\n  messagingSenderId: \"722704825746\",\n  appId: \"1:722704825746:web:73f11551b9e59f4bc2d54b\",\n  measurementId: \"G-YJ97DZH6V5\"\n};\nvar db = '';\nif (!getApps().length){ \n  const firebaseApp = initializeApp(firebaseConfig);\n  db = getFirestore(firebaseApp);\n}else{\n  db = getFirestore();\n}\n\nexport default function QuestionList (props) {\n\n  const theme = createMuiTheme({\n    palette: {\n      primary: {\n        main: 'rgb(3, 122, 255)',\n      },\n      secondary: {\n        main: '#f50057',\n      },\n      green: {\n        main: 'rgb(40, 168, 69)',\n      }\n    },\n  });\n\n  const uid = localStorage.getItem('chooseoneUid');\n  // const [your_vote, setYourVote] = useState(null);\n  const [answered, setAnswered] = useState(false);\n  const styles = useStyles();\n  var l = [];\n  var v = [];\n  var c = [];\n\n  const the_question = props.the_question;\n  const notLoaded = (the_question.category === null || the_question.category === undefined);\n  const smallDisplay = useMediaQuery('(max-width:500px)');\n  var choiceSkeleton = [];\n\n  for(var i=0; i<(5-smallDisplay*2); i++){\n    choiceSkeleton.push(\n      <div>\n        <label for=\"choice{idx}\">\n          <Skeleton duration={2.5} width={150} height={10}/>\n        </label>\n      </div>\n    )\n  }\n\n  if(the_question !== 'skeleton' && the_question !== undefined){\n    var copy = the_question.choices;\n\n    for(let i=0; i<copy.length;  i++){\n      l.push(copy[i].choice_text);\n      v.push(copy[i].votes);\n    }\n\n    var time = the_question.created_at;\n    var seconds = parseInt(time.slice(-2));\n    if(v !== []){\n      v.forEach((entry, idx) => {\n        c.push('hsla('+((idx+seconds)*70)+',75%,75%,1)');\n      });\n    }\n  }\n\n  useEffect(() => {\n    if(uid === null) return null;\n\n    // const u = doc(db, 'users', uid);\n    // const promise = new Promise(function(resolve) {\n    //   resolve(getDoc(u));\n    // })\n    // promise.then((us) => {\n    //   if(us.exists){\n    //     var the_user = us.data();\n\n    //     if(the_user.question_voted.some((q) => q.question === the_question.slug)){\n    //       setAnswered(true);\n    //     }\n    //   }\n    // });\n  });\n\n  const onChoice = async (idx) => {\n    var the_slug = the_question.slug;\n    var your_vote = the_question.choices[idx].choice_text;\n\n    setAnswered(true);\n\n    var copy = Object.create(the_question);\n\n    copy.choices[idx].votes=parseInt(copy.choices[idx].votes, 10)+1;\n    \n\n    await updateDoc(doc(db, 'questions', the_question.slug), {\n      choices: copy.choices,\n      all_votes: increment(1),\n      users_voted: arrayUnion(uid),\n    });\n\n    await updateDoc(doc(db, 'users', uid), {\n      question_voted: arrayUnion({ question: the_slug, answer: your_vote }),\n    })\n  }\n\n  return (\n    <Fragment>\n      <div className={styles.onepost}>\n        \n        <p className='cali2' style={{ fontSize: 12 }}><span className='text-primary fa fa-tag'></span>\n          Category:\n          {!notLoaded && (\n            <Fragment>\n              {the_question.category.map((cate, idx) => {\n                if ( idx === 0){\n                  return (<a className='text-primary' href={'/category/'+cate}> {cate}</a>)\n                }else{\n                  return (<a className='text-primary' href={'/category/'+cate}>, {cate}</a>)\n                }\n              })}\n            </Fragment>\n          )}\n          {notLoaded && <Skeleton style={{ marginLeft: 10 }} width={60} />}\n        </p>\n        <h4 style={{ fontSize: 19 }} className='cali2'><a className={styles.link} href={'/q/'+the_question.slug}>{!notLoaded ? the_question.title : <SkeletonTheme color=\"white\" highlightColor=\"#d3d3d3\"><Skeleton duration={2.5} width={'80%'} height={20}  /></SkeletonTheme> }</a></h4>\n\n        <div className={styles.choices} style={{ paddingLeft: smallDisplay && answered && 0, paddingRight: !smallDisplay && answered && 35 }}>\n          <ul style={{ paddingLeft: 0 }}>\n            {!notLoaded && (\n              <Fragment>\n                {!answered ?\n                  <Fragment>\n                    {the_question.choices.map((choice,idx) => (\n                      <div>\n                        {/* <label for=\"choice{idx}\">○ {choice.choice_text}</label>\n                        <br></br> */}\n                        <StyledButton variant=\"outlined\" onClick={() => onChoice(idx)} size=\"small\" color=\"primary\">\n                          {choice.choice_text}\n                        </StyledButton>\n                      </div>\n                    ))}\n                  </Fragment>\n                  :\n                  <Fragment>\n                    <div className={styles.HoriChart}><HoriChart small={smallDisplay} skeleton={notLoaded} labels={l} values={v} colors={c} /></div>\n                  </Fragment>\n                }\n              </Fragment>\n            )}\n            {notLoaded && [choiceSkeleton]}\n          </ul>\n        </div>\n        <div className={styles.more}>\n          <ThemeProvider theme={theme}>\n            <ButtonGroup size={smallDisplay ? 'small' : 'default'} disableElevation variant=\"contained\" >\n              <Button variant='contained' onClick={() => window.location.href = '/q/'+the_question.slug } color=\"primary\">\n                More\n              </Button>\n            </ButtonGroup>\n          </ThemeProvider>\n        </div>\n      </div>\n    </Fragment>\n  );\n}\n\nconst useStyles = makeStyles(() => createStyles({\n  more: {\n    marginBottom: 10,\n    marginLeft: 12,\n  },\n  onepost: {\n    padding: 10,\n    paddingLeft: 15,\n    marginBottom: 15,\n    filter: 'drop-shadow(0px 0px 5px rgba(160, 160, 160, 0.7))',\n    backgroundColor: 'white',\n    position: 'relative',\n    borderRadius: 15,\n  },\n\n  choices: {\n    paddingLeft: 40,\n  },\n\n  link: {\n    color: 'black',\n    '&:hover': {\n      background: 'linear-gradient(transparent 70%, #45cafb 0%)',\n      textDecoration: 'none',\n    }\n  },\n  \n  '@media (max-width: 500px)': {\n    onepost: {\n      borderRadius: 0,\n      marginBottom: 5,\n      paddingLeft: 10,\n      paddingBottom: 1,\n      filter: 'none',\n\n      link: {\n        '&:hover': {\n          background: 'none',\n        }\n      }\n    }\n  }\n}));\n\nconst StyledButton = withStyles({\n  root: {\n    borderRadius: 7,\n    borderColor: '#696969', \n    borderWidth: 0.1,\n    color: '#696969', \n    fontSize: 11, \n    width: Math.min(200, window.innerWidth*0.5),\n    textTransform: 'none',\n    margin: 2,\n    paddingLeft: 12,\n    alignItems: 'center',\n    justifyContent: 'start',\n  },\n\n  '@media (max-width: 500px)': {\n    root: {\n      width: window.innerWidth*0.5,\n    }\n  }\n})(Button);"]},"metadata":{},"sourceType":"module"}